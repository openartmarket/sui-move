"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.handleTransactionResponse = exports.getSigner = exports.provider = void 0;
const sui_js_1 = require("@mysten/sui.js");
const config_1 = require("./config");
// console.log("Connecting to ", SUI_NETWORK);
const connOptions = new sui_js_1.Connection({
    fullnode: config_1.SUI_NETWORK,
});
exports.provider = new sui_js_1.JsonRpcProvider(connOptions);
function getSigner(phrase) {
    if (!phrase)
        throw new Error("No phrase provided");
    const keypair = sui_js_1.Ed25519Keypair.deriveKeypair(phrase);
    const signer = new sui_js_1.RawSigner(keypair, exports.provider);
    const address = keypair.getPublicKey().toSuiAddress();
    // console.log("Address = " + address);
    return { signer, address };
}
exports.getSigner = getSigner;
function handleTransactionResponse(txRes) {
    const status = (0, sui_js_1.getExecutionStatus)(txRes);
    if (status === undefined) {
        throw new Error("Failed to get execution status");
    }
    if (status.error) {
        throw new Error(status.error);
    }
    if (status.status !== "success") {
        throw new Error(`Transaction failed with status: ${status.status}`);
    }
}
exports.handleTransactionResponse = handleTransactionResponse;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGVscGVycy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9oZWxwZXJzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLDJDQU93QjtBQUV4QixxQ0FBdUM7QUFFdkMsOENBQThDO0FBQzlDLE1BQU0sV0FBVyxHQUFHLElBQUksbUJBQVUsQ0FBQztJQUNqQyxRQUFRLEVBQUUsb0JBQVc7Q0FDdEIsQ0FBQyxDQUFDO0FBQ1UsUUFBQSxRQUFRLEdBQUcsSUFBSSx3QkFBZSxDQUFDLFdBQVcsQ0FBQyxDQUFDO0FBRXpELFNBQWdCLFNBQVMsQ0FBQyxNQUFjO0lBSXRDLElBQUksQ0FBQyxNQUFNO1FBQUUsTUFBTSxJQUFJLEtBQUssQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO0lBRW5ELE1BQU0sT0FBTyxHQUFHLHVCQUFjLENBQUMsYUFBYSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ3JELE1BQU0sTUFBTSxHQUFHLElBQUksa0JBQVMsQ0FBQyxPQUFPLEVBQUUsZ0JBQVEsQ0FBQyxDQUFDO0lBRWhELE1BQU0sT0FBTyxHQUFHLE9BQU8sQ0FBQyxZQUFZLEVBQUUsQ0FBQyxZQUFZLEVBQUUsQ0FBQztJQUN0RCx1Q0FBdUM7SUFFdkMsT0FBTyxFQUFFLE1BQU0sRUFBRSxPQUFPLEVBQUUsQ0FBQztBQUM3QixDQUFDO0FBYkQsOEJBYUM7QUFFRCxTQUFnQix5QkFBeUIsQ0FBQyxLQUFrQztJQUMxRSxNQUFNLE1BQU0sR0FBRyxJQUFBLDJCQUFrQixFQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ3pDLElBQUksTUFBTSxLQUFLLFNBQVMsRUFBRTtRQUN4QixNQUFNLElBQUksS0FBSyxDQUFDLGdDQUFnQyxDQUFDLENBQUM7S0FDbkQ7SUFDRCxJQUFJLE1BQU0sQ0FBQyxLQUFLLEVBQUU7UUFDaEIsTUFBTSxJQUFJLEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUM7S0FDL0I7SUFDRCxJQUFJLE1BQU0sQ0FBQyxNQUFNLEtBQUssU0FBUyxFQUFFO1FBQy9CLE1BQU0sSUFBSSxLQUFLLENBQUMsbUNBQW1DLE1BQU0sQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDO0tBQ3JFO0FBQ0gsQ0FBQztBQVhELDhEQVdDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQ29ubmVjdGlvbixcbiAgRWQyNTUxOUtleXBhaXIsXG4gIGdldEV4ZWN1dGlvblN0YXR1cyxcbiAgSnNvblJwY1Byb3ZpZGVyLFxuICBSYXdTaWduZXIsXG4gIFN1aVRyYW5zYWN0aW9uQmxvY2tSZXNwb25zZSxcbn0gZnJvbSBcIkBteXN0ZW4vc3VpLmpzXCI7XG5cbmltcG9ydCB7IFNVSV9ORVRXT1JLIH0gZnJvbSBcIi4vY29uZmlnXCI7XG5cbi8vIGNvbnNvbGUubG9nKFwiQ29ubmVjdGluZyB0byBcIiwgU1VJX05FVFdPUkspO1xuY29uc3QgY29ubk9wdGlvbnMgPSBuZXcgQ29ubmVjdGlvbih7XG4gIGZ1bGxub2RlOiBTVUlfTkVUV09SSyxcbn0pO1xuZXhwb3J0IGNvbnN0IHByb3ZpZGVyID0gbmV3IEpzb25ScGNQcm92aWRlcihjb25uT3B0aW9ucyk7XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRTaWduZXIocGhyYXNlOiBzdHJpbmcpOiB7XG4gIHNpZ25lcjogUmF3U2lnbmVyO1xuICBhZGRyZXNzOiBzdHJpbmc7XG59IHtcbiAgaWYgKCFwaHJhc2UpIHRocm93IG5ldyBFcnJvcihcIk5vIHBocmFzZSBwcm92aWRlZFwiKTtcblxuICBjb25zdCBrZXlwYWlyID0gRWQyNTUxOUtleXBhaXIuZGVyaXZlS2V5cGFpcihwaHJhc2UpO1xuICBjb25zdCBzaWduZXIgPSBuZXcgUmF3U2lnbmVyKGtleXBhaXIsIHByb3ZpZGVyKTtcblxuICBjb25zdCBhZGRyZXNzID0ga2V5cGFpci5nZXRQdWJsaWNLZXkoKS50b1N1aUFkZHJlc3MoKTtcbiAgLy8gY29uc29sZS5sb2coXCJBZGRyZXNzID0gXCIgKyBhZGRyZXNzKTtcblxuICByZXR1cm4geyBzaWduZXIsIGFkZHJlc3MgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGhhbmRsZVRyYW5zYWN0aW9uUmVzcG9uc2UodHhSZXM6IFN1aVRyYW5zYWN0aW9uQmxvY2tSZXNwb25zZSk6IHZvaWQge1xuICBjb25zdCBzdGF0dXMgPSBnZXRFeGVjdXRpb25TdGF0dXModHhSZXMpO1xuICBpZiAoc3RhdHVzID09PSB1bmRlZmluZWQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gZ2V0IGV4ZWN1dGlvbiBzdGF0dXNcIik7XG4gIH1cbiAgaWYgKHN0YXR1cy5lcnJvcikge1xuICAgIHRocm93IG5ldyBFcnJvcihzdGF0dXMuZXJyb3IpO1xuICB9XG4gIGlmIChzdGF0dXMuc3RhdHVzICE9PSBcInN1Y2Nlc3NcIikge1xuICAgIHRocm93IG5ldyBFcnJvcihgVHJhbnNhY3Rpb24gZmFpbGVkIHdpdGggc3RhdHVzOiAke3N0YXR1cy5zdGF0dXN9YCk7XG4gIH1cbn1cbiJdfQ==